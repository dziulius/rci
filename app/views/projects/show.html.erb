<% title t('projects.show.heading', :name => @project.name) %>

<h1><%= t('projects.show.heading') %></h1>

<ul class="info">
  <%= field_list_item(@project, :id) %>
  <%= field_list_item(@project, :name) %>
  <%= field_list_item(@project, :leader, :name) %>
  <%= field_list_item(@project, :leader, :department, :name) %>
  <%= field_list_item(@project, :start_at) %>
  <%= field_list_item(@project, :end_at) %>
</ul>

<% form_tag project_users_path(@project, :format => 'js'), :id => "period_select" do %>
    <%= compact_month_select :date_from, @project.start_at, @project.start_at, @project.end_at %>
    <%= compact_month_select :date_to, @project.end_at, @project.start_at, @project.end_at %>
<% end %>

<% if @project.start_at and @project.end_at %>
    <% content_for :javascripts do %>
        <script type="text/javascript">
            $(function() {
                $('#date_from, #date_to').selectToUISlider({sliderOptions:{
                    change: function() {
                        $('#users').load($('#period_select').attr('action'), $.param($($('#period_select')).serializeArray()));
                    }
                }});
            });

            function optionFromSlider(from, n, slider) {
                return $(from + ' > option:eq(' + slider.slider('values', n) + ')').attr('value');
            }
        </script>
    <% end %>
<% end %>

<div id="users">
  <%= render :partial => "users" %>
</div>

<%= link_to t('projects.show.edit_link'), edit_project_path(@project) %> |
<%= link_to t('projects.show.back_link'), projects_path %>